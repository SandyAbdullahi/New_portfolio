<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Abdullahinur — Portfolio</title>
  <meta name="theme-color" content="#1A2318" />
  <meta name="description" content="Abdullahinur — Web Developer & Designer" />

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Playfair+Display:wght@700;800&display=swap"
    rel="stylesheet">

  <style>
    :root {
      --green: #1A2318;
      --lime: #C6E376;
      --cream: #EDEBDD;
      --white: #FFFFFF;
    }

    html,
    body {
      overflow-x: hidden;
      background: var(--white);
    }

    body {
      font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color: var(--green);
    }

    /* nav underline */
    .nav-a {
      position: relative;
    }

    .nav-a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: -6px;
      height: 2px;
      width: 0;
      background: var(--green);
      transition: width .25s ease;
    }

    .nav-a:hover::after {
      width: 100%;
    }

    /* film grain */
    .grain {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      opacity: .45;
      mix-blend-mode: multiply;
      pointer-events: none;
      z-index: 50;
    }

    @media (prefers-reduced-motion: reduce) {
      .grain {
        opacity: .05;
      }
    }

    /* make sure the WebGL canvas fills and is centered with the section grid */
    #hero3d {
      position: relative;
      display: grid;
      place-items: center;
    }

    canvas.webgl {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
    }

    /* Center hero phrases */
    .hero-phrases {
      display: grid;
      place-items: center;
      /* centers inner content */
      text-align: center;
    }

    /* Phrases overlap at the center */
    .phrase {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      opacity: 0;
      filter: blur(10px);
      transform-origin: center;
    }


    /* left list scroller look */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    /* PANELS: we don’t animate the shell, only the text inside */
    .panel {
      display: none;
    }

    .panel.active {
      display: block;
    }

    .panel-3d canvas {
      cursor: grab;
      touch-action: none;
    }

    .panel-3d.grabbing canvas {
      cursor: grabbing;
    }

    /* dissolve only text inside panels */
    .panel-text {
      opacity: 0;
      filter: blur(10px);
      transform: translateY(8px);
    }

    /* showcase word hover/active */
    .scroll-item {
      position: relative;
    }

    .big-word {
      position: relative;
      z-index: 1;
      transition: transform .28s cubic-bezier(.2, .8, .2, 1), color .2s ease;
      will-change: transform;
    }

    /* lime highlight bar behind the word */
    .scroll-item::before {
      content: "";
      position: absolute;
      inset: 0;
      top: 20%;
      height: 60%;
      background: rgba(198, 227, 118, 0.18);
      /* --lime at low alpha */
      transform: scaleX(0);
      transform-origin: left center;
      transition: transform .35s ease;
      z-index: 0;
    }

    /* hover & active states */
    .scroll-item:hover::before,
    .scroll-item.is-active::before {
      transform: scaleX(1);
    }

    .scroll-item:hover .big-word,
    .scroll-item.is-active .big-word {
      color: var(--lime);
      transform: translateX(.2vw) skewX(-1.2deg);
    }
  </style>
</head>

<body class="overflow-x-hidden">

  <!-- Global Film Grain -->
  <svg class="grain" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">
    <filter id="noiseFilter">
      <feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="4" stitchTiles="stitch">
        <animate attributeName="baseFrequency" values="0.65;0.9;0.65" dur="6s" repeatCount="indefinite" />
      </feTurbulence>
      <feColorMatrix type="saturate" values="0" />
    </filter>
    <rect width="100%" height="100%" filter="url(#noiseFilter)"></rect>
  </svg>

  <!-- Navbar -->
  <header class="relative z-40 bg-white/90 backdrop-blur">
    <div class="max-w-6xl mx-auto flex items-center justify-between px-6 md:px-10 py-5">
      <div class="uppercase tracking-widest text-sm">Portfolio</div>
      <nav class="hidden md:flex gap-8 uppercase tracking-widest text-sm">
        <a href="#work" class="nav-a">Work</a>
        <a href="#about" class="nav-a">About</a>
        <a href="#contact" class="nav-a">Contact</a>
      </nav>
      <div class="md:hidden w-3 h-3 rounded-full" style="background:var(--green)"></div>
    </div>
    <div class="max-w-6xl mx-auto px-6 md:px-10">
      <div class="h-0 border-t-2" style="border-color:var(--green)"></div>
    </div>
  </header>

  <!-- HERO: Orbiting rings + dissolving phrases -->
  <section id="hero3d" class="relative min-h-[90vh] bg-white overflow-hidden grid place-items-center">
    <canvas id="ringsCanvas" class="webgl absolute inset-0"></canvas>

    <!-- Centered via grid -->
    <div class="hero-phrases relative z-20 w-full text-center">
      <span class="phrase text-[clamp(2rem,6vw,4rem)] font-extrabold text-[var(--green)]"
        style="font-family:'Playfair Display',serif">Brutalist&nbsp;Developer</span>
      <span class="phrase text-[clamp(2rem,6vw,4rem)] font-extrabold text-[var(--green)]"
        style="font-family:'Playfair Display',serif">UI&nbsp;/&nbsp;UX&nbsp;Designer</span>
      <span class="phrase text-[clamp(2rem,6vw,4rem)] font-extrabold text-[var(--green)]"
        style="font-family:'Playfair Display',serif">Performance-First</span>
      <span class="phrase text-[clamp(2rem,6vw,4rem)] font-extrabold text-[var(--green)]"
        style="font-family:'Playfair Display',serif">Web&nbsp;Engineer</span>
    </div>
  </section>


  <!-- SHOWCASE: full-viewport words (left) + sticky panels (right) with 3D -->
  <section id="showcase" class="bg-[var(--cream)] text-[var(--green)] p-0 m-0 overflow-x-hidden">
    <div class="w-full grid md:grid-cols-12 gap-0">

      <!-- LEFT: full-bleed list -->
      <div class="md:col-span-5 relative z-0 overflow-visible">
        <ul id="topicList" class="no-scrollbar h-screen overflow-y-scroll snap-y snap-mandatory
                   w-screen pl-0 ml-0">

          <li class="scroll-item snap-start h-screen m-0 p-0 select-none flex items-center" data-panel="p1">
            <span class="big-word block font-extrabold uppercase tracking-tight whitespace-nowrap
                         text-[100vh] leading-[0.62] -mt-[0.04em] -mb-[0.04em]">
              Design
            </span>
          </li>

          <li class="scroll-item snap-start h-screen m-0 p-0 select-none flex items-center" data-panel="p2">
            <span class="big-word block font-extrabold uppercase tracking-tight whitespace-nowrap
                         text-[100vh] leading-[0.62] -mt-[0.04em] -mb-[0.04em]">
              Build
            </span>
          </li>

          <li class="scroll-item snap-start h-screen m-0 p-0 select-none flex items-center" data-panel="p3">
            <span class="big-word block font-extrabold uppercase tracking-tight whitespace-nowrap
                         text-[100vh] leading-[0.62] -mt-[0.04em] -mb-[0.04em]">
              Motion
            </span>
          </li>

          <li class="scroll-item snap-start h-screen m-0 p-0 select-none flex items-center" data-panel="p4">
            <span class="big-word block font-extrabold uppercase tracking-tight whitespace-nowrap
                         text-[100vh] leading-[0.62] -mt-[0.04em] -mb-[0.04em]">
              Ship
            </span>
          </li>
        </ul>
      </div>

      <!-- RIGHT: sticky wrapper (panel shell stays; only text dissolves) -->
      <div class="md:col-span-7 relative z-10">
        <!-- no outer padding; panel borders hug the column edges -->
        <div class="sticky top-0 bg-[var(--cream)] p-0">
          <div class="min-h-[0px] space-y-0">

            <!-- DESIGN -->
            <article id="p1" class="panel active">
              <!-- keep internal padding; outside is now zero -->
              <div class="border-2 border-[var(--green)] p-8 md:p-10 bg-white">
                <div class="grid md:grid-cols-2 gap-6 items-stretch">
                  <div class="panel-copy">
                    <h3 class="panel-text text-3xl md:text-4xl font-extrabold uppercase mb-4">Design</h3>
                    <p class="panel-text max-w-prose text-black/80">
                      Type-led systems, grids, and intent. Replace the demo with a painter/architect-table model (.glb)
                      anytime.
                    </p>
                    <div class="panel-text mt-8 h-0 border-t-2 border-[var(--green)]/30"></div>
                  </div>
                  <!-- 3D -->
                  <div class="panel-3d relative h-56 md:h-64 lg:h-72 border-2 border-[var(--green)]/20"
                    data-model="assets/3d_objects/honor.glb" data-autorotate="true">
                    <canvas class="webgl absolute inset-0"></canvas>
                  </div>
                </div>
              </div>
            </article>

            <!-- ENGINEERING -->
            <article id="p2" class="panel">
              <div class="border-2 border-[var(--green)] p-8 md:p-10 bg-white">
                <div class="grid md:grid-cols-2 gap-6 items-stretch">
                  <div class="panel-copy">
                    <h3 class="panel-text text-3xl md:text-4xl font-extrabold uppercase mb-4">Engineering</h3>
                    <p class="panel-text max-w-prose text-black/80">Robust front-ends, solid APIs, clean integrations.
                    </p>
                    <div class="panel-text mt-8 h-0 border-t-2 border-[var(--green)]/30"></div>
                  </div>
                  <div class="panel-3d relative h-56 md:h-64 lg:h-72 border-2 border-[var(--green)]/20"
                    data-model="assets/3d_objects/Avocado.glb" data-autorotate="true">
                    <canvas class="webgl absolute inset-0"></canvas>
                  </div>
                </div>
              </div>
            </article>

            <!-- MOTION & 3D -->
            <article id="p3" class="panel">
              <div class="border-2 border-[var(--green)] p-8 md:p-10 bg-white">
                <div class="grid md:grid-cols-2 gap-6 items-stretch">
                  <div class="panel-copy">
                    <h3 class="panel-text text-3xl md:text-4xl font-extrabold uppercase mb-4">Motion & 3D</h3>
                    <p class="panel-text max-w-prose text-black/80">GSAP & Three.js sequences, scroll-driven reveals,
                      tasteful depth.</p>
                    <div class="panel-text mt-8 h-0 border-t-2 border-[var(--green)]/30"></div>
                  </div>
                  <div class="panel-3d relative h-56 md:h-64 lg:h-72 border-2 border-[var(--green)]/20"
                    data-model="https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Avocado/glTF-Binary/Avocado.glb"
                    data-autorotate="false">
                    <canvas class="webgl absolute inset-0"></canvas>
                  </div>
                </div>
              </div>
            </article>

            <!-- DELIVERY -->
            <article id="p4" class="panel">
              <div class="border-2 border-[var(--green)] p-8 md:p-10 bg-white">
                <div class="grid md:grid-cols-2 gap-6 items-stretch">
                  <div class="panel-copy">
                    <h3 class="panel-text text-3xl md:text-4xl font-extrabold uppercase mb-4">Delivery</h3>
                    <p class="panel-text max-w-prose text-black/80">CI/CD, analytics, performance budgets—ship with
                      intent.</p>
                    <div class="panel-text mt-8 h-0 border-t-2 border-[var(--green)]/30"></div>
                  </div>
                  <div class="panel-3d relative h-56 md:h-64 lg:h-72 border-2 border-[var(--green)]/20"
                    data-model="assets/3d_objects/cardbox.gltf" data-autorotate="true">
                    <canvas class="webgl absolute inset-0"></canvas>
                  </div>
                </div>
              </div>
            </article>

          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- CTA / CONTACT -->
  <section id="contact" class="bg-white text-[var(--green)] py-24 md:py-32 px-6 md:px-10">
    <div class="max-w-6xl mx-auto">
      <h3 class="text-5xl md:text-6xl font-extrabold leading-none">Let’s<br><span class="pl-24">Talk</span></h3>
      <p class="mt-6 max-w-md text-black/80">Ready to collaborate? I’m an email away—let’s build something bold and
        purposeful.</p>
      <a href="mailto:hello@abdullahinur.dev"
        class="mt-8 inline-block border-2 border-[var(--green)] text-[var(--green)] px-8 py-3 uppercase tracking-wider font-medium transition-colors duration-300 hover:bg-[var(--green)] hover:text-white">
        hello@abdullahinur.dev
      </a>
      <div class="mt-12 h-0 border-t-2 border-[var(--green)]/20"></div>
    </div>
  </section>

  <!-- Three.js (global) + GLTFLoader (global) + GSAP -->
  <!-- GSAP (keep) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>

  <!-- Import map for Three.js ESM -->
  <script type="importmap">
    {
  "imports": {
    "three": "https://cdn.jsdelivr.net/npm/three@0.159.0/build/three.module.js",
    "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.159.0/examples/jsm/"
  }
}
</script>


  <!-- App code (ES modules) -->
  <script type="module">
    import * as THREE from 'three';
  import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
  import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

/* ---------- HERO rings (centered + MORE morphing shapes) ---------- */
(() => {
  const canvas = document.getElementById('ringsCanvas');
  const hero   = document.getElementById('hero3d');

  const scene = new THREE.Scene();
  scene.background = new THREE.Color('#ffffff');

  const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 100);
  camera.position.set(0, 0, 7.2);
  camera.lookAt(0, 0, 0);

  const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: false });

  function setSize() {
    const { width, height } = hero.getBoundingClientRect();
    renderer.setSize(width, height, false);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 1.5));
    camera.aspect = width / height;
    camera.updateProjectionMatrix();
  }
  setSize(); addEventListener('resize', setSize);

  scene.add(new THREE.AmbientLight(0xffffff, 0.95));

  const orbitRoot = new THREE.Group();
  scene.add(orbitRoot);

  // ---------- helpers ----------
  const vec = (x,y)=>new THREE.Vector3(x,y,0);

  // circle / ellipse
  const makeCircle  = (n, r)=>Array.from({length:n},(_,i)=>{const a=i/n*2*Math.PI;return vec(Math.cos(a)*r,Math.sin(a)*r)});
  const makeEllipse = (n, rx,ry)=>Array.from({length:n},(_,i)=>{const a=i/n*2*Math.PI;return vec(Math.cos(a)*rx,Math.sin(a)*ry)});

  // Lissajous
  const makeLissajous = (n, ax, ay, phase, s)=>Array.from({length:n},(_,i)=>{
    const t=i/n*2*Math.PI; return vec(Math.sin(ax*t+phase)*s, Math.sin(ay*t)*s);
  });

  // Heart (parametric, scaled)
  const makeHeart = (n, s)=>{
    const pts=[]; let maxR=0;
    for(let i=0;i<n;i++){
      const t=i/n*2*Math.PI;
      const x=16*Math.sin(t)**3;
      const y=13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);
      const r=Math.hypot(x,y); if(r>maxR) maxR=r;
      pts.push(vec(x,y));
    }
    const k=s/(maxR||1); return pts.map(p=>p.multiplyScalar(k));
  };

  // Star
  const makeStar = (n, r1,r2,points=5)=>{
    const m=Math.max(n,points*2);
    const tmp=Array.from({length:m},(_,i)=>{
      const a=i/m*2*Math.PI; const r=(i%2===0)?r1:r2; return vec(Math.cos(a)*r,Math.sin(a)*r);
    });
    // resample to n
    return Array.from({length:n},(_,i)=>{
      const t=i/(n-1)*(m-1); const i0=Math.floor(t), i1=Math.min(m-1,i0+1), f=t-i0;
      return new THREE.Vector3().lerpVectors(tmp[i0], tmp[i1], f);
    });
  };

  // NEW: Superellipse / Squircle: |x/a|^n + |y/b|^n = 1
  const makeSuperellipse = (n, a,b, pow=4)=>{
    const pts=[];
    for(let i=0;i<n;i++){
      const t = i/n * 2*Math.PI;
      const ct=Math.cos(t), st=Math.sin(t);
      const x = Math.sign(ct)*a*Math.pow(Math.abs(ct), 2/pow);
      const y = Math.sign(st)*b*Math.pow(Math.abs(st), 2/pow);
      pts.push(vec(x,y));
    }
    return pts;
  };

  // NEW: Lemniscate of Bernoulli (infinity)
  const makeLemniscate = (n, s)=>{
    const a=s;
    const pts=[];
    for(let i=0;i<n;i++){
      const t=i/n*2*Math.PI;
      const denom = 1 + Math.sin(t)**2;
      const x = (a*Math.SQRT2*Math.cos(t))/denom;
      const y = (a*Math.SQRT2*Math.cos(t)*Math.sin(t))/denom;
      pts.push(vec(x,y));
    }
    return pts;
  };

  // NEW: Rose / Clover r = cos(kθ)
  const makeRose = (n, k, s)=>{
    const pts=[];
    for(let i=0;i<n;i++){
      const t=i/n*2*Math.PI;
      const r = Math.cos(k*t)*s;
      pts.push(vec(r*Math.cos(t), r*Math.sin(t)));
    }
    return pts;
  };

  // NEW: Spirograph (hypotrochoid)
  // R: fixed circle radius, r: rolling radius, d: pen offset
  const makeSpiro = (n, R,r,d, scale=1)=>{
    const pts=[];
    const k = R/r;
    for(let i=0;i<n;i++){
      const t=i/n*2*Math.PI;
      const x=(R - r)*Math.cos(t) + d*Math.cos((R - r)/r * t);
      const y=(R - r)*Math.sin(t) - d*Math.sin((R - r)/r * t);
      pts.push(vec(x*scale, y*scale));
    }
    return pts;
  };

  // ---------- ring factory ----------
  function makeDotRing({ radius, count, dotRadius, color, tiltX, tiltY }) {
    const mat  = new THREE.MeshStandardMaterial({ color, roughness:.35, metalness:.25 });
    const geom = new THREE.SphereGeometry(dotRadius, 16, 16);
    const ring = new THREE.Group();
    ring.rotation.x = tiltX;
    ring.rotation.y = tiltY;

    // start on a circle
    const base = makeCircle(count, radius);
    for(let i=0;i<count;i++){
      const m=new THREE.Mesh(geom,mat);
      m.position.copy(base[i]);
      ring.add(m);
    }
    orbitRoot.add(ring);

    ring.morphTo = (targets, dur=2.4) => {
      const kids = ring.children;
      const N = Math.min(kids.length, targets.length);
      gsap.killTweensOf(kids.map(k=>k.position));
      gsap.to(kids.map(k=>k.position), {
        x:(i)=>targets[i].x, y:(i)=>targets[i].y, z:(i)=>targets[i].z,
        duration: dur, ease:"power3.inOut",
        stagger:{ each:.012, from:"center" }
      });
    };
    return ring;
  }

  // rings (palette/tilts)
  const inner = makeDotRing({ radius:2.1, count:20, dotRadius:.036, color:'#1A2318', tiltX:Math.PI*.22, tiltY:Math.PI*.15 });
  const mid   = makeDotRing({ radius:2.7, count:20, dotRadius:.034, color:'#6E8256', tiltX:Math.PI*.62, tiltY:-Math.PI*.18 });
  const outer = makeDotRing({ radius:3.3, count:20, dotRadius:.032, color:'#C6E376', tiltX:Math.PI*.40, tiltY:-Math.PI*1.0 });

  // programs (each returns [innerPts, midPts, outerPts])
  const progs = [
    (c)=>[ makeCircle(c,2.1),         makeCircle(c,2.7),            makeCircle(c,3.3) ],
    (c)=>[ makeEllipse(c,2.4,1.6),    makeEllipse(c,3.0,2.0),       makeEllipse(c,3.7,2.2) ],
    (c)=>[ makeLissajous(c,3,2,Math.PI/2,1.8), makeLissajous(c,5,4,Math.PI/3,2.4), makeLissajous(c,4,3,Math.PI/4,3.0) ],
    (c)=>[ makeHeart(c,2.2),          makeHeart(c,2.8),             makeHeart(c,3.4) ],
    (c)=>[ makeStar(c,2.3,1.2,5),     makeStar(c,3.0,1.5,5),        makeStar(c,3.8,1.8,5) ],

    // NEW sets:
    (c)=>[ makeSuperellipse(c,2.1,2.1,3.6),  makeSuperellipse(c,2.7,2.4,3.6),  makeSuperellipse(c,3.4,2.9,3.6) ],        // squircles
    (c)=>[ makeSuperellipse(c,2.8,1.6,5.2),  makeSuperellipse(c,3.4,1.9,5.2),  makeSuperellipse(c,4.1,2.2,5.2) ],        // rounded rects
    (c)=>[ makeRose(c,4,1.9),               makeRose(c,5,2.4),                 makeRose(c,6,3.0) ],                     // roses
    (c)=>[ makeSpiro(c,5,3,4, .35),         makeSpiro(c,7,3,5, .36),           makeSpiro(c,9,4,5, .37) ],               // spirographs
    (c)=>[ makeLemniscate(c,2.2),           makeLemniscate(c,2.7),             makeLemniscate(c,3.2) ],                 // infinity
  ];

  const reduce   = matchMedia('(prefers-reduced-motion: reduce)').matches;
  const MORPH_D  = 2.6;
  const HOLD_D   = 1.1;

  if (!reduce){
    let i=0;
    const cycle = ()=>{
      const [a,b,c] = progs[i % progs.length](inner.children.length);
      inner.morphTo(a, MORPH_D);
      mid.morphTo(b, MORPH_D);
      outer.morphTo(c, MORPH_D);

      // subtle tilt change per program
      const tiltPresets = [
        { x:Math.PI*.22, y: Math.PI*.15 },
        { x:Math.PI*.35, y: Math.PI*.05 },
        { x:Math.PI*.55, y:-Math.PI*.10 },
        { x:Math.PI*.25, y:-Math.PI*.25 },
        { x:Math.PI*.42, y:-Math.PI*.90 },
        { x:Math.PI*.30, y: Math.PI*.12 },
        { x:Math.PI*.48, y:-Math.PI*.18 },
        { x:Math.PI*.36, y: Math.PI*.08 },
        { x:Math.PI*.52, y:-Math.PI*.22 },
        { x:Math.PI*.40, y:-Math.PI*.70 },
      ][i % 10];

      gsap.to([inner.rotation, mid.rotation, outer.rotation], {
        x:(idx)=> tiltPresets.x + (idx-1)*0.06,
        y:(idx)=> tiltPresets.y - (idx-1)*0.08,
        duration:MORPH_D, ease:"power2.inOut"
      });

      i++; gsap.delayedCall(MORPH_D + HOLD_D, cycle);
    };
    cycle();
  }

  // gentle overall spin
  const clock = new THREE.Clock();
  (function tick(){
    if (!reduce){
      inner.rotation.z +=  0.0055;
      mid.rotation.z   += -0.0045;
      outer.rotation.z +=  0.0038;
    }
    renderer.render(scene, camera);
    requestAnimationFrame(tick);
  })();
})();



  /* ---------- Hero phrases dissolve (loop) ---------- */
(() => {
  const phrases = gsap.utils.toArray(".phrase");
  // ❌ remove this if you had it:
  // gsap.set(".hero-phrases", { position: "absolute" });

  gsap.set(phrases, { opacity: 0, filter: "blur(10px)", y: 10, zIndex: (i) => 100 - i });

  const tl = gsap.timeline({ repeat: -1, repeatDelay: 0.2 });
  phrases.forEach((el) => {
    tl.to(el, { opacity: 1, filter: "blur(0px)", y: 0, duration: 0.9, ease: "power3.out" })
      .to(el, { opacity: 0, filter: "blur(12px)", y: -10, duration: 0.8, ease: "power3.in" }, "+=0.9");
  });
})();

/* ---------- Showcase: activate + text-only dissolve (with active word) ---------- */
(() => {
  const list   = document.getElementById('topicList');
  const items  = [...list.querySelectorAll('.scroll-item')];
  const panels = [...document.querySelectorAll('#showcase .panel')];

  // map panel id -> li element
  const itemByPanel = items.reduce((m, li) => (m.set(li.dataset.panel, li), m), new Map());

  const ensurePanel3DReady = (panelEl) => {
    panelEl.querySelectorAll('.panel-3d').forEach(c => {
      window.__initViewerIfNeeded && window.__initViewerIfNeeded(c, /*forceResize*/true);
    });
  };

  function activate(id){
    // panels
    panels.forEach(p => {
      const active = (p.id === id);
      p.classList.toggle('active', active);
      if (active) {
        ensurePanel3DReady(p);
        const texts = p.querySelectorAll('.panel-text');
        gsap.fromTo(texts,
          { opacity:0, filter:"blur(10px)", y:8 },
          { opacity:1, filter:"blur(0px)", y:0, stagger:0.08, duration:.55, ease:"power3.out" }
        );
      }
    });

    // words (left list)
    items.forEach(li => li.classList.toggle('is-active', li.dataset.panel === id));
  }

  items.forEach(li=>{
    li.addEventListener('mouseenter', ()=>activate(li.dataset.panel));
    li.addEventListener('focus',      ()=>activate(li.dataset.panel));
  });

  const io = new IntersectionObserver(entries=>{
    entries.forEach(e=>{ if (e.isIntersecting) activate(e.target.dataset.panel); });
  }, { root:list, threshold: 0.8 });
  items.forEach(el=>io.observe(el));
})();

 /* ---------- Panel 3D viewers (lazy init + OrbitControls) ---------- */
  (() => {
    const reduce = matchMedia('(prefers-reduced-motion: reduce)').matches;
    const viewers = [];
    const viewerMap = new WeakMap(); // container -> viewer

    function initViewer(container) {
      if (viewerMap.has(container)) return viewerMap.get(container);

      const canvas     = container.querySelector('canvas');
      const url        = container.dataset.model;
      const autorotate = container.dataset.autorotate === 'true';

      const scene    = new THREE.Scene(); // transparent
      const camera   = new THREE.PerspectiveCamera(45, 1, 0.01, 1000);
      const renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
      renderer.setClearColor(0x000000, 0);

      const hemi = new THREE.HemisphereLight(0xffffff, 0x444444, 0.9);
      const dir  = new THREE.DirectionalLight(0xffffff, 0.9); dir.position.set(3,4,6);
      scene.add(hemi, dir);

      // OrbitControls (interactive)
      const controls = new OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.08;

      controls.enablePan = true;          // ✅ allow repositioning
      controls.screenSpacePanning = true; // pan straight up/down relative to screen
      controls.panSpeed = 0.9;

      controls.rotateSpeed = 0.7;
      controls.zoomSpeed   = 0.9;
      // keep the orbit from flipping upside down (optional but nice)
      controls.minPolarAngle = 0.05;
      controls.maxPolarAngle = Math.PI - 0.05;

      // smooth zoom-to-cursor (optional, remove if your OrbitControls version complains)
      controls.zoomToCursor = true;

      controls.target.set(0,0,0);
      controls.update();


      const setSize = () => {
        const w = container.clientWidth || 1;
        const h = container.clientHeight || 1;
        renderer.setSize(w, h, false);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 1.5));
        camera.aspect = w / h; camera.updateProjectionMatrix();
      };
      setSize();

      // Resize when container box changes (e.g., becomes visible)
      const ro = new ResizeObserver(() => setSize());
      ro.observe(container);

      const loader = new GLTFLoader();
      let mixer = null, root = null, auto = autorotate;
      let reEnableAutoTO = null;

      loader.load(
        url,
        (gltf) => {
          root = gltf.scene;
          scene.add(root);

          // Center & frame model
          const box    = new THREE.Box3().setFromObject(root);
          const size   = box.getSize(new THREE.Vector3()).length();
          const center = box.getCenter(new THREE.Vector3());
          root.position.sub(center);

          const fov = camera.fov * (Math.PI/180);
          let dist = (size/2) / Math.tan(fov/2);
          dist *= 1.25;
          camera.position.set(0, 0, dist);
          camera.near = size/1000; camera.far = size*10; camera.updateProjectionMatrix();

          // Controls limits based on model size
          controls.minDistance = dist * 0.6;
          controls.maxDistance = dist * 4.0;
          controls.target.set(0,0,0);
          controls.update();

          if (gltf.animations && gltf.animations.length){
            mixer = new THREE.AnimationMixer(root);
            gltf.animations.forEach(clip => mixer.clipAction(clip).play());
            auto = false; // animation drives motion
          }
        },
        undefined,
        (err) => console.warn('GLTF load error:', url, err)
      );

      // Pause autorotate while interacting, resume after idle
      const startUser = () => {
        container.classList.add('grabbing');
        auto = false;
        clearTimeout(reEnableAutoTO);
      };
      const endUser = () => {
        container.classList.remove('grabbing');
        reEnableAutoTO = setTimeout(() => {
          // resume only if no animation clips
          if (!mixer && container.dataset.autorotate === 'true' && !reduce) auto = true;
        }, 1800);
      };

      renderer.domElement.addEventListener('pointerdown', startUser);
      addEventListener('pointerup', endUser);
      renderer.domElement.addEventListener('wheel', startUser, { passive: true });

      const state = { visible:false };
      const viewer = {
        renderer, scene, camera, controls, state,
        get mixer(){ return mixer; },
        get root(){  return root;  },
        get auto(){  return auto;  },
        resize: setSize
      };

      viewerMap.set(container, viewer);
      viewers.push(viewer);
      return viewer;
    }

    // Allow other code (activate()) to force init/resize
    window.__initViewerIfNeeded = (container, forceResize=false) => {
      const v = initViewer(container);
      if (forceResize) v.resize();
      return v;
    };

    // Observe visibility: init on first intersect, toggle render flag thereafter
    document.querySelectorAll('.panel-3d').forEach(container => {
      const obs = new IntersectionObserver(entries => {
        entries.forEach(e => {
          if (e.isIntersecting) {
            const v = initViewer(container);
            v.state.visible = true;
            v.resize();
          } else {
            const v = viewerMap.get(container);
            if (v) v.state.visible = false;
          }
        });
      }, { threshold: 0.01 });
      obs.observe(container);
    });

    // Render loop
    const clock = new THREE.Clock();
    (function loop(){
      const dt = clock.getDelta();
      viewers.forEach(v => {
        if (!v.state.visible) return;
        if (v.mixer) v.mixer.update(dt);
        if (v.root && v.auto && !reduce) v.root.rotation.y += 0.6 * dt;
        v.controls.update();
        v.renderer.render(v.scene, v.camera);
      });
      requestAnimationFrame(loop);
    })();
  })();
</script>

</body>

</html>